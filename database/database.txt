CREATE DATABASE IF NOT EXISTS PuroEncanto;
USE PuroEncanto;

CREATE TABLE IF NOT EXISTS tipouser (
    id INT PRIMARY KEY AUTO_INCREMENT,
    descricao VARCHAR(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS Utilizador (
    ID_Utilizador INT PRIMARY KEY AUTO_INCREMENT,
    Nome VARCHAR(100) NOT NULL,
    Email VARCHAR(100) NOT NULL,
    Password VARCHAR(255) NOT NULL,
    id_tipouser INT,
    FOREIGN KEY (id_tipouser) REFERENCES tipouser(id)
        ON DELETE SET NULL
);


CREATE TABLE IF NOT EXISTS Fornecedores (
    ID_Fornecedor INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(100) NOT NULL,
	contacto VARCHAR(15),
    email VARCHAR(100),
    morada VARCHAR(100) NOT NULL
);


CREATE TABLE IF NOT exists Produtos (
    ID_Produto INT PRIMARY KEY AUTO_INCREMENT,
    nome VARCHAR(100) NOT NULL,
    preco DECIMAL(10,2) NOT NULL
);


CREATE TABLE IF NOT exists Fornecimento (
    ID_Fornecimento INT PRIMARY KEY AUTO_INCREMENT,
    Data DATE NOT NULL,
    Quantidade INT NOT NULL,
    ID_Fornecedor INT,
    ID_Produto INT,
    FOREIGN KEY (ID_Fornecedor) REFERENCES Fornecedores(ID_Fornecedor)
        ON DELETE CASCADE,
    FOREIGN KEY (ID_Produto) REFERENCES Produtos(ID_Produto)
        ON DELETE CASCADE
);


CREATE TABLE IF NOT exists Servicos (
    ID_Servico INT PRIMARY KEY AUTO_INCREMENT,
    Descricao VARCHAR(255) NOT NULL,
    Preco DECIMAL(10,2) NOT NULL
);

CREATE TABLE IF NOT exists Venda (
    ID_Venda INT PRIMARY KEY AUTO_INCREMENT,
    Data DATE NOT NULL,
    ValorTotal DECIMAL(10,2) NOT NULL,
    ID_Utilizador INT,
    FOREIGN KEY (ID_Utilizador) REFERENCES Utilizador(ID_Utilizador)
        ON DELETE SET NULL
);

CREATE TABLE IF NOT exists Rendimento (
    ID_Rendimento INT PRIMARY KEY AUTO_INCREMENT,
    Valor DECIMAL(10,2) NOT NULL,
    Data DATE NOT NULL,
    ID_Venda INT,
    FOREIGN KEY (ID_Venda) REFERENCES Venda(ID_Venda)
        ON DELETE SET NULL
);

CREATE TABLE IF NOT exists Gastos (
    ID_Gasto INT PRIMARY KEY AUTO_INCREMENT,
    Descricao VARCHAR(255),
    Valor DECIMAL(10,2) NOT NULL,
    Data DATE NOT NULL
);

CREATE TABLE IF NOT exists TiposEventos (
    ID_TipoEvento INT PRIMARY KEY AUTO_INCREMENT,
    Nome VARCHAR(100) NOT NULL
);

CREATE TABLE IF NOT exists Eventos (
    ID_Evento INT PRIMARY KEY AUTO_INCREMENT,
    Nome VARCHAR(100) NOT NULL,
    Data DATE NOT NULL,
    Localizacao VARCHAR(100),
    ID_TipoEvento INT,
    FOREIGN KEY (ID_TipoEvento) REFERENCES TiposEventos(ID_TipoEvento)
        ON DELETE SET NULL
);

INSERT INTO tipouser (descricao) VALUES 
('Administrador'), 
('Cliente');


INSERT INTO Utilizador (Nome, Email, Password, id_tipouser) VALUES
('Pedro Silva', 'pedro@email.com', 'senha123', 1),
('Ana Costa', 'ana@email.com', 'senha456', 2);


INSERT INTO Fornecedores (Nome, Contacto, Email, Morada) VALUES
('Fornecedor A', '917654321', 'fornA@email.com', 'Bairro da Casinha'),
('Fornecedor B', '918765432', 'fornB@email.com', 'Fria Aleixo');

INSERT INTO Produtos (Nome, Preco) VALUES
('Relógio Clássico', 120.00),
('Relógio Moderno', 180.50);


INSERT INTO Fornecimento (Data, Quantidade, ID_Fornecedor, ID_Produto) VALUES
('2025-08-01', 5, 1, 1),
('2025-08-03', 3, 2, 2);


INSERT INTO Servicos (Descricao, Preco) VALUES
('Limpeza de relógio', 25.00),
('Reparação de bracelete', 40.00);


INSERT INTO Venda (Data, ValorTotal, ID_Utilizador) VALUES
('2025-08-05', 200.00, 1);


INSERT INTO Rendimento (Valor, Data, ID_Venda) VALUES
(200.00, '2025-08-05', 1);


INSERT INTO Gastos (Descricao, Valor, Data) VALUES
('Compra de material de limpeza', 35.00, '2025-08-02'),
('Publicidade online', 50.00, '2025-08-04');


INSERT INTO TiposEventos (Nome) VALUES
('Promoção'),
('Feira');

INSERT INTO Eventos (Nome, Data, Localizacao, ID_TipoEvento) VALUES
('Black Friday', '2025-11-29', 'Loja Principal', 1),
('Feira de Natal', '2025-12-10', 'Centro Comercial', 2);

select * from tipouser;

