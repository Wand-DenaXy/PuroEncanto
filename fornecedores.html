<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puro Encanto - Fornecedores</title>
    
    <link rel="stylesheet" href="asset/css/fornecedores.css">
    <link rel="stylesheet" href="asset/css/lib/datatables.css">
    <link rel="stylesheet" href="asset/css/lib/select2.css">
    <link rel="stylesheet" href="asset/css/lib/bootstrap.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">

    <script src="asset/js/lib/jquery.js"></script>
    <script src="asset/js/lib/bootstrap.js"></script>
    <script src="asset/js/lib/datatables.js"></script>
    <script src="asset/js/lib/select2.js"></script>
    <script src="asset/js/lib/sweatalert.js"></script>

</head>

<body>
    <div class="sidebar">
        <a href="index.php" style="background-color: transparent;border-left: none;">
            <div class="logo">
                <img src="images/logos/PURO ENCANTO LOGO.png" alt="Puro Encanto">
                <p class="logotitulo">Puro Encanto</p>
            </div>
        </a>
        <a href="dashboard.php">
            <i class="bi bi-grid-fill"></i> Dashboard
        </a>
        <a href="gastoserendimentos.html">
            <i class="bi bi-cash-stack"></i> Gastos e Rendimentos
        </a>
        <a href="servicosadmin.html">
            <i class="bi bi-cart-fill"></i> Vendas
        </a>
        <a href="fornecedores.html" class="active">
            <i class="bi bi-truck"></i> Fornecedores
        </a>
        <a href="clientes.html">
            <i class="bi bi-people-fill"></i> Clientes
        </a>
        <a href="funcionario.html">
            <i class="bi bi-person-badge-fill"></i> Funcionários
        </a>
        <a href="calendario.html">
            <i class="bi bi-calendar3"></i> Calendário
        </a>
        <a href="economicofinanceiro.php">
            <i class="bi bi-graph-up-arrow"></i> Económico-Financeiro
        </a>
       
        <a href="perfilAdmin.php">
            <i class="bi bi-person-circle"></i> Perfil
        </a>
        <div class="time" id="time"></div>
    </div>

    <div class="content">
        <div class="page-header">
            <h2>
                <i class="bi bi-truck"></i>
                Gestão de Fornecedores
            </h2>
        </div>

        <div class="container-fluid">
            <div class="row">
                <div class="col-md-6">
                    <div class="form-card">
                        <h5>
                            <i class="bi bi-plus-circle-fill"></i>
                            Adicionar Fornecedor
                        </h5>
                        <form>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="descricao" class="form-label">Nome</label>
                                    <input type="text" class="form-control" id="descricao" placeholder="Nome do fornecedor">
                                </div>
                                <div class="col-md-6">
                                    <label for="contacto" class="form-label">Contacto</label>
                                    <input type="text" class="form-control" id="contacto" placeholder="(+351) 000 000 000">
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="email" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="email" placeholder="email@exemplo.com">
                                </div>
                                <div class="col-md-6">
                                    <label for="morada" class="form-label">Morada</label>
                                    <input type="text" class="form-control" id="morada" placeholder="Endereço completo">
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="nif" class="form-label">NIF</label>
                                    <input type="text" class="form-control" id="nif" placeholder="000000000">
                                </div>
                                <div class="col-md-6">
                                    <label for="total_debito" class="form-label">Total de Débito (€)</label>
                                    <input type="number" class="form-control" id="total_debito" placeholder="0.00" step="0.01">
                                </div>
                            </div>
                            <button type="button" class="btinfoperfil" onclick="registaFornecedores()">
                                <i class="bi bi-plus-circle"></i> Registar Fornecedor
                            </button>
                        </form>
                    </div>
                </div>

                <div class="col-md-6">
                    <div class="form-card success">
                        <h5>
                            <i class="bi bi-file-earmark-arrow-up-fill"></i>
                            Importar Fornecedores (CSV)
                        </h5>
                        <div class="mb-3">
                            <label for="csvFile" class="form-label">Selecione o arquivo CSV</label>
                            <input type="file" class="form-control" id="csvFile" accept=".csv">
                            <small class="form-text text-muted">
                                <i class="bi bi-info-circle"></i> O arquivo deve conter: Nome, Contacto, Email, Morada, NIF, Total Débito
                            </small>
                        </div>
                        <button class="btn-success" onclick="importarSessoesCSV()">
                            <i class="bi bi-upload"></i> Importar Fornecedores
                        </button>
                    </div>

                    <div class="form-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
                        <h5 style="color: white; border-bottom-color: rgba(255,255,255,0.3);">
                            <i class="bi bi-info-circle-fill"></i>
                            Informações Importantes
                        </h5>
                        <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                            <li>Certifique-se de preencher todos os campos obrigatórios</li>
                            <li>O NIF deve conter 9 dígitos</li>
                            <li>Formato do CSV: separado por vírgulas</li>
                            <li>Contacto no formato: +351 000 000 000</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="table-card">
                <h5>
                    <i class="bi bi-table"></i>
                    Lista de Fornecedores
                </h5>
                <div class="table-responsive">
                    <table class="table table-striped table-hover" id="tblFornecedores">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nome</th>
                                <th>Contacto</th>
                                <th>Email</th>
                                <th>Morada</th>
                                <th>NIF</th>
                                <th>Total Débito</th>
                                <th class="text-center">Editar</th>
                                <th class="text-center">Remover</th>
                            </tr>
                        </thead>
                        <tbody id="listagemFornecedores">
                            <tr>
                                <td colspan="8" class="text-center">
                                    <div class="loading-spinner"></div>
                                    <p class="mt-2">Carregando fornecedores...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Editar Fornecedor -->
    <div class="modal fade" id="formEditFornecedores" tabindex="-1" aria-labelledby="modalEditLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalEditLabel">
                        <i class="bi bi-pencil-square"></i>
                        Editar Fornecedor
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <form class="row g-3">
                            <div class="col-md-3">
                                <label for="numFornecedorEdit" class="form-label">Número</label>
                                <input type="number" class="form-control" id="numFornecedorEdit" disabled>
                            </div>
                            <div class="col-md-9">
                                <label for="descricaoEdit" class="form-label">Nome</label>
                                <input type="text" class="form-control" id="descricaoEdit">
                            </div>
                            <div class="col-md-6">
                                <label for="contactoEdit" class="form-label">Contacto</label>
                                <input type="tel" class="form-control" id="contactoEdit">
                            </div>
                            <div class="col-md-6">
                                <label for="emailEdit" class="form-label">Email</label>
                                <input type="email" class="form-control" id="emailEdit">
                            </div>
                            <div class="col-md-12">
                                <label for="moradaEdit" class="form-label">Morada</label>
                                <input type="text" class="form-control" id="moradaEdit">
                            </div>
                            <div class="col-md-6">
                                <label for="nifEdit" class="form-label">NIF</label>
                                <input type="text" class="form-control" id="nifEdit">
                            </div>
                            <div class="col-md-6">
                                <label for="total_debitoEdit" class="form-label">Total Débito (€)</label>
                                <input type="number" step="0.01" class="form-control" id="total_debitoEdit">
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Fechar
                    </button>
                    <button type="button" class="btinfoperfil2" id="btnGuardar">
                        <i class="bi bi-check-circle"></i> Guardar Alterações
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="asset/js/fornecedores.js"></script>
    <script>
 function atualizarHora() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            const elemento = document.getElementById('time');
            if (elemento) {
                elemento.textContent = now.toLocaleDateString('pt-PT', options);
            }
        }
        
        atualizarHora();
        setInterval(atualizarHora, 60000);
    </script>
</body>
</html>